{% extends 'todo/base.html' %}

{% block content %}

<body>
<div>
    {% if course_list %}
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a href="#tab-home" class="nav-link active" data-toggle="tab">Home</a>
            </li>
            {% for course in course_list %}
                <li class="nav-item">
                    <a href="#tab{{course.id}}" class="nav-link" data-toggle="tab">{{course.course_name}}</a>
                </li>
            {% endfor %}
        </ul>


        <div class="tab-content">
            <div class="tab-pane fade show active" id="tab-home">
                </div>
            {% for course in course_list %}
                <div style="margin-top:20px;" class="tab-pane fade" id="tab{{course.id}}">
                  {% if course.course_abbrev %}
                    <h4>Welcome to {{ course.course_abbrev }}: {{course.course_name}}!</h4>
                  {% else %}
                    <h4>Welcome to {{course.course_name}}!</h4>
                  {% endif %}
                    <div class="row">
                        <div class="col">
                          <div class="d-flex justify-content-center">
                            {% if course.todoitem_set.all %}
                              <ul class="w-50 list-group">
                                <div id="accordion">
                                  <!-- accordion is the template for collapsing bars -->
                                  {% for todo_item in course.todoitem_set.all %}
                                    <div class="card">
                                      <button
                                        class="btn collapsed"
                                        id="cardButton"
                                        data-toggle="collapse"
                                        data-target="#collapse{{forloop.counter}}"
                                      >
                                      <li class="list-group-item">
                                        {% if todo_item.priority == "HI" and not todo_item.completed %}
                                        <div class="card-header border border-danger" id="header{{forloop.counter}}">
                                        {% elif todo_item.priority == "MD" and not todo_item.completed %}
                                        <div class="card-header border border-warning" id="header{{forloop.counter}}">
                                        {% else %}
                                        <div class="card-header border bg-light" id="header{{forloop.counter}}">
                                        {% endif %}

                                        <p class="d-flex justify-content-start">
                                          {% if not todo_item.completed %}
                                            {{todo_item.title}}
                                          {% else %}
                                            <del>{{todo_item.title}}</del>
                                          {% endif %}
                                        </p>

                                        <div class="d-flex justify-content-around mt-3">
                                          {% if todo_item.completed %}
                                            <small><i>Task Completed!</i></small>
                                          {% elif todo_item.is_past_due %}
                                            <small><i style="color:red">Past due!</i></small>
                                          {% endif %}
                                          <small>due {{todo_item.duedate}}</small>
                                        </div>
                                        </div>
                                      </button>
                                        <!--forloop.counter gives each instance of todo_item a different id so each box collapses independently of each other -->
                                        <div id="collapse{{forloop.counter}}" class="collapse">
                                          <!--body of the accordion card -->
                                          <div class="card-body">
                                            <ul style="list-style-type:none">
                                              {% if todo_item.description %}
                                              <li>
                                                <strong>Description:</strong> {{ todo_item.description }}
                                              </li>
                                              {% endif %} {% if todo_item.location %}
                                              <li><strong>Location:</strong> {{ todo_item.location }}</li>
                                              {% endif %}
                                              {% if todo_item.recur_freq != 'NEVER' %}
                                                <li><strong>Repeat:</strong> {{ todo_item.recur_freq }}</li>
                                                <li>
                                                  <strong>End repeat:</strong> {{ todo_item.end_recur_date }}</li>
                                              {% endif %}
                                              {% if todo_item.category != 'NN' %}
                                                <li><strong>Category:</strong> {{ todo_item.category }}</li>
                                                {% if todo_item.category == 'AC' %}
                                                  {% if todo_item.course %}
                                                    <li><strong>Course:</strong> {{ todo_item.course }}</li>
                                                  {% endif %}
                                                {% elif todo_item.category == 'EC' %}
                                                  {% if todo_item.ec %}
                                                    <li><strong>Activity:</strong> {{ todo_item.ec }}</li>
                                                  {% endif %}
                                                {% endif %}
                                              {% endif %}
                                            </ul>
                                            <div class="row m-sm-3">
                                              <div>
                                                {% if not todo_item.completed %}
                                                <small><a
                                                  class="text-success" href="{% url 'todo_list:complete_todo' todo_item.id %}"
                                                  >âœ… Complete Task</a
                                                ></small>
                                                {% else %}
                                                <small><a
                                                  href="{% url 'todo_list:complete_todo' todo_item.id %}"
                                                >Undo completion</a></small>
                                                {% endif %}
                                              </div>
                                              <div class="ml-auto">
                                                <small class="m-2"
                                                  ><a href="{% url 'todo_list:detail' todo_item.id %}"
                                                    >ðŸ–Š Edit</a
                                                  ></small
                                                >
                                                <small><a
                                                  class="text-danger" href="{% url 'todo_list:delete_todo_item' todo_item.id %}"
                                                  >ðŸ—‘ Delete</a
                                                ></small>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </li>
                                    </div>
                                  {% endfor %}
                                </div>
                              </ul>
                            {% else %}
                              <!-- TODO!!!!!!!!!!!!!!!! -->
                            {% endif %}
                          </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

</div>
</body>

{% endblock %}